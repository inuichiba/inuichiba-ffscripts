# Cloudflare Workersã®KVãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹ã«ã¤ã„ã¦ã€ä»¥ä¸‹ã®5é …ç›®ã®ä½¿ç”¨çŠ¶æ³ã‚’æ¯æ—¥ãƒã‚§ãƒƒã‚¯ï¼š
# - Read / Write / Delete / List ã®å„ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ•°
# - ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ä½¿ç”¨é‡ï¼ˆ1GBä¸Šé™ï¼‰
# ã„ãšã‚Œã‹ãŒ80%ã‚’è¶…ãˆãŸå ´åˆã«ã€Discordé€šçŸ¥ã¨GitHub Actionsã®å¤±æ•—é€šçŸ¥ã‚’è¡Œã„ã¾ã™

name: ğŸ’¾ KV Usage Monitorï¼ˆCloudflare KVã®ä½¿ç”¨é‡ç›£è¦– & è­¦å‘Šé€šçŸ¥ï¼‰

on:
  workflow_dispatch:  # âœ… æ‰‹å‹•å®Ÿè¡Œå¯èƒ½ã«ã™ã‚‹
  schedule:
    - cron: '0 0 * * *'  # æ¯æ—¥ JST 09:00ï¼ˆUTC 0:30ï¼‰

jobs:
  monitor:
    runs-on: ubuntu-latest
    env:
      DISCORD_WEBHOOK_URL: ${{ secrets.DISCORD_WEBHOOK_URL }}
      CF_API_TOKEN: ${{ secrets.CF_API_TOKEN }}
    steps:
      - uses: actions/checkout@v4
      - name: Install node-fetch
        run: npm install node-fetch
      - name: Run KV usage checker
        run: node check-kv-usage.js
